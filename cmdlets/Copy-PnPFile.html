<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Copy-PnPFile | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Copy-PnPFile | PnP PowerShell ">
    <meta name="generator" content="docfx 2.51.0.0">
    <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="copy-pnpfile">Copy-PnPFile</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Copies a file or folder to a different location. This location can be within the same document library, same site, same site collection or even to another site collection on the same tenant. Currently there is a 200MB file size limit for the file or folder to be copied.</p>
<h2 id="syntax">SYNTAX</h2>
<pre><code>Copy-PnPFile [-SourceUrl] &lt;String&gt; [-TargetUrl] &lt;String&gt; [-OverwriteIfAlreadyExists] [-Force]
 [-SkipSourceFolderName] [-IgnoreVersionHistory] [-Web &lt;WebPipeBind&gt;] [-Connection &lt;PnPConnection&gt;] [-WhatIf]
 [-Confirm] [&lt;CommonParameters&gt;]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/MyDocs -TargetUrl /sites/otherproject/Documents -SkipSourceFolderName -OverwriteIfAlreadyExists
</code></pre>
<p>Copies a folder named MyDocs in the document library called Documents located in the current site to the root folder of the library named Documents in the site collection otherproject.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -ServerRelativeUrl &quot;/sites/project/Shared Documents/company.docx&quot; -TargetServerRelativeLibrary &quot;/sites/otherproject/Shared Documents&quot;
</code></pre>
<p>Copies a file named company.docx located in a document library called Shared Documents in the site collection project to the Shared Documents library in the site collection otherproject. If a file named company.docx already exists, it won't perform the copy.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/company.docx -TargetUrl /sites/otherproject/Documents/company.docx
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents in the current site to the site collection otherproject. If a file named company.docx already exists, it won't perform the copy.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -ServerRelativeUrl &quot;/sites/project/Shared Documents/Archive&quot; -TargetServerRelativeLibrary &quot;/sites/otherproject/Shared Documents&quot; -OverwriteIfAlreadyExists
</code></pre>
<p>Copies a folder named Archive located in a document library called Shared Documents in the site collection project to the Shared Documents library in the site collection otherproject. If a folder named Archive already exists, it will overwrite it.</p>
<h3 id="example-5">EXAMPLE 5</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/company.docx -TargetUrl Documents/company2.docx
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents to a new document named company2.docx in the same library.</p>
<h3 id="example-6">EXAMPLE 6</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/company.docx -TargetUrl Documents2/company.docx
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents to a document library called Documents2 in the same site.</p>
<h3 id="example-7">EXAMPLE 7</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/company.docx -TargetUrl Subsite/Documents/company2.docx
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents to the document library named Document in a subsite named Subsite as a new document named company2.docx.</p>
<h3 id="example-8">EXAMPLE 8</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/company.docx -TargetUrl Subsite/Documents
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents to the document library named Document in a subsite named Subsite keeping the file name.</p>
<h3 id="example-9">EXAMPLE 9</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/company.docx -TargetUrl /sites/otherproject/Documents/company.docx -OverwriteIfAlreadyExists
</code></pre>
<p>Copies a file named company.docx located in a document library called Documents in the current site to the site collection otherproject. If a file named company.docx already exists, it will still perform the copy and replace the original company.docx file.</p>
<h3 id="example-10">EXAMPLE 10</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/MyDocs -TargetUrl /sites/otherproject/Documents -OverwriteIfAlreadyExists
</code></pre>
<p>Copies a folder named MyDocs in the document library called Documents located in the current site to the site collection otherproject. If the MyDocs folder exist it will copy into it, if not it will be created.</p>
<h3 id="example-11">EXAMPLE 11</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/MyDocs -TargetUrl /sites/otherproject/Documents/MyDocs -SkipSourceFolderName -OverwriteIfAlreadyExists
</code></pre>
<p>Copies a folder named MyDocs in the MyDocs folder of the library named Documents. If the MyDocs folder does not exists, it will be created.</p>
<h3 id="example-12">EXAMPLE 12</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl Documents/MyDocs -TargetUrl /sites/otherproject/Documents/MyDocs -OverwriteIfAlreadyExists
</code></pre>
<p>Copies a folder named MyDocs in the root of the library named Documents. If the MyDocs folder exists in the target, a subfolder also named MyDocs is created.</p>
<h3 id="example-13">EXAMPLE 13</h3>
<pre><code class="lang-powershell">PS:&gt;Copy-PnPFile -SourceUrl SubSite1/Documents/company.docx -TargetUrl SubSite2/Documents
</code></pre>
<p>Copies a file named company.docx in the library named Documents in SubSite1 to the library named Documents in SubSite2.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-confirm">-Confirm</h3>
<p>Prompts you for confirmation before running the cmdlet.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases: cf

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-force">-Force</h3>
<p>If provided, no confirmation will be requested and the action will be performed</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-ignoreversionhistory">-IgnoreVersionHistory</h3>
<p>If provided, only the latest version of the document will be copied and its history will be discared. If not provided, all historical versions will be copied along.</p>
<p>Only applicable to: SharePoint Online</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-overwriteifalreadyexists">-OverwriteIfAlreadyExists</h3>
<p>If provided, if a file already exists at the TargetUrl, it will be overwritten. If omitted, the copy operation will be canceled if the file already exists at the TargetUrl location.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-skipsourcefoldername">-SkipSourceFolderName</h3>
<p>If the source is a folder, the source folder name will not be created, only the contents within it</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-sourceurl">-SourceUrl</h3>
<p>Site or server relative Url specifying the file or folder to copy. Must include the file name if it's a file or the entire path to the folder if it's a folder.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)
Aliases: SiteRelativeUrl, ServerRelativeUrl

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
</code></pre>
<h3 id="-targeturl">-TargetUrl</h3>
<p>Server relative Url where to copy the file or folder to. Must not include the file name.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: (All)
Aliases: TargetServerRelativeLibrary

Required: True
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-web">-Web</h3>
<p>This parameter allows you to optionally apply the cmdlet action to a subweb within the current web. In most situations this parameter is not required and you can connect to the subweb using Connect-PnPOnline instead. Specify the GUID, server relative url (i.e. /sites/team1) or web instance of the web to apply the command to. Omit this parameter to use the current web.</p>
<pre><code class="lang-yaml">Type: WebPipeBind
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-whatif">-WhatIf</h3>
<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases: wi

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/sppnp">SharePoint Developer Patterns and Practices</a></p>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>