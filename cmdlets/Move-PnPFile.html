<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html lang="en">
  
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Move-PnPFile | PnP PowerShell </title>
    <meta name="viewport" content="width=device-width">
    <meta name="title" content="Move-PnPFile | PnP PowerShell ">
    <meta name="generator" content="docfx 2.51.0.0">
    <meta name="description" content="PnP PowerShell is an open source, community driven, PowerShell Module designed to work with Microsoft 365.">
    <link rel="shortcut icon" href="https://c.s-microsoft.com/favicon.ico?v2">
    <link rel="stylesheet" href="../styles/docfx.vendor.css">
    <link rel="stylesheet" href="../styles/docfx.css">
    <link rel="stylesheet" href="../styles/main.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet"> 
    <meta property="docfx:navrel" content="../toc.html">
    <meta property="docfx:tocrel" content="toc.html">
    
    <meta property="docfx:rel" content="../">
    <meta property="docfx:newtab" content="true">
  </head>  <body data-spy="scroll" data-target="#affix" data-offset="120">
    <div id="wrapper">
      <header>
        
        <nav id="autocollapse" class="navbar navbar-inverse ng-scope" role="navigation">
          <div class="container">
            <div class="navbar-header">
              <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </button>
              
              <a class="navbar-brand" href="../index.html">
                <img id="logo" class="svg" src="../images/logo.svg" alt="">
              </a>
            </div>
            <div class="collapse navbar-collapse" id="navbar">
              <form class="navbar-form navbar-right" role="search" id="search">
                <div class="form-group">
                  <label class="glyphicon glyphicon-search" for="search-query"></label>
                  <input type="text" class="form-control" id="search-query" placeholder="Search" autocomplete="off">
                </div>
              </form>
            </div>
          </div>
        </nav>        
        <div class="subnav navbar navbar-default">
          <div class="container hide-when-search" id="breadcrumb">
            <ul class="breadcrumb">
              <li></li>
            </ul>
          </div>
        </div>
      </header>
      <div class="container body-content">
        
        <div id="search-results">
          <div class="search-list"></div>
          <div class="sr-items">
            <p><i class="glyphicon glyphicon-refresh index-loading"></i></p>
          </div>
          <ul id="pagination"></ul>
        </div>
      </div>
      <div role="main" class="container body-content hide-when-search">
        
        <div class="sidenav hide-when-search">
          <a class="btn toc-toggle collapse" data-toggle="collapse" href="#sidetoggle" aria-expanded="false" aria-controls="sidetoggle">Show / Hide Table of Contents</a>
          <div class="sidetoggle collapse" id="sidetoggle">
            <div id="sidetoc"></div>
          </div>
        </div>
        <div class="article row grid-right">
          <div class="col-md-10">
            <article class="content wrap" id="_content" data-uid="">
                
                  <div class="contribution-panel mobile-hide pull-right">
                      <a href="https://github.com/pnp/powershell/blob/dev/documentation/#L1" title="Improve this Doc" class="improve-doc-lg"><i class="glyphicon glyphicon-pencil"></i></a>
                  </div>
                    <h1 id="move-pnpfile">Move-PnPFile</h1>

<h2 id="synopsis">SYNOPSIS</h2>
<p>Moves a file or folder to a different location</p>
<h2 id="syntax">SYNTAX</h2>
<h3 id="site-relative-default">Site Relative (Default)</h3>
<pre><code>Move-PnPFile [-SiteRelativeUrl] &lt;String&gt; [-TargetUrl] &lt;String&gt; [-OverwriteIfAlreadyExists] [-Force]
 [-Web &lt;WebPipeBind&gt;] [-Connection &lt;PnPConnection&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]
</code></pre>
<h3 id="server-relative">Server Relative</h3>
<pre><code>Move-PnPFile [-ServerRelativeUrl] &lt;String&gt; [-TargetUrl] &lt;String&gt; [-OverwriteIfAlreadyExists] [-Force]
 [-Web &lt;WebPipeBind&gt;] [-Connection &lt;PnPConnection&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]
</code></pre>
<h3 id="other-site-collection">Other Site Collection</h3>
<pre><code>Move-PnPFile [[-ServerRelativeUrl] &lt;String&gt;] [[-SiteRelativeUrl] &lt;String&gt;]
 [-TargetServerRelativeLibrary] &lt;String&gt; [-OverwriteIfAlreadyExists] [-AllowSchemaMismatch]
 [-AllowSmallerVersionLimitOnDestination] [-IgnoreVersionHistory] [-Force] [-Web &lt;WebPipeBind&gt;]
 [-Connection &lt;PnPConnection&gt;] [-WhatIf] [-Confirm] [&lt;CommonParameters&gt;]
</code></pre>
<h2 id="description">DESCRIPTION</h2>
<p>Allows moving a file or folder to a different location inside the same document library, such as in a subfolder, to a different document library on the same site collection or to a document library on another site collection</p>
<h2 id="examples">EXAMPLES</h2>
<h3 id="example-1">EXAMPLE 1</h3>
<pre><code class="lang-powershell">PS:&gt;Move-PnPFile -SiteRelativeUrl &quot;Shared Documents/Document.docx&quot; -TargetUrl &quot;/sites/project/Archive/Document2.docx&quot;
</code></pre>
<p>Moves a file named Document.docx located in the document library named &quot;Shared Documents&quot; in the current site to the document library named &quot;Archive&quot; in the same site, renaming the file to Document2.docx. If a file named Document2.docx already exists at the destination, it won't perform the move.</p>
<h3 id="example-2">EXAMPLE 2</h3>
<pre><code class="lang-powershell">PS:&gt;Move-PnPFile -ServerRelativeUrl &quot;/sites/project/Shared Documents/Document.docx -TargetUrl &quot;/sites/project/Archive/Document.docx&quot; -OverwriteIfAlreadyExists
</code></pre>
<p>Moves a file named Document.docx located in the document library named &quot;Shared Documents&quot; in the current site to the document library named &quot;Archive&quot; in the same site. If a file named Document.docx already exists at the destination, it will overwrite it.</p>
<h3 id="example-3">EXAMPLE 3</h3>
<pre><code class="lang-powershell">PS:&gt;Move-PnPFile -ServerRelativeUrl &quot;/sites/project/Shared Documents/Document.docx&quot; -TargetServerRelativeLibrary &quot;/sites/otherproject/Shared Documents&quot; -OverwriteIfAlreadyExists -AllowSchemaMismatch -AllowSmallerVersionLimitOnDestination
</code></pre>
<p>Moves a file named Document.docx located in the document library named &quot;Shared Documents&quot; in the current site to the document library named &quot;Shared Documents&quot; in another site collection &quot;otherproject&quot; allowing it to overwrite an existing file Document.docx in the destination, allowing the fields to be different on the destination document library from the source document library and allowing a lower document version limit on the destination compared to the source.</p>
<h3 id="example-4">EXAMPLE 4</h3>
<pre><code class="lang-powershell">PS:&gt;Move-PnPFile -ServerRelativeUrl &quot;/sites/project/Shared Documents/Archive&quot; -TargetServerRelativeLibrary &quot;/sites/archive/Project&quot; -AllowSchemaMismatch -AllowSmallerVersionLimitOnDestination
</code></pre>
<p>Moves a folder named Archive located in the document library named &quot;Shared Documents&quot; in the current site to the document library named &quot;Project&quot; in another site collection &quot;archive&quot; not allowing it to overwrite an existing folder named &quot;Archive&quot; in the destination, allowing the fields to be different on the destination document library from the source document library and allowing a lower document version limit on the destination compared to the source.</p>
<h2 id="parameters">PARAMETERS</h2>
<h3 id="-allowschemamismatch">-AllowSchemaMismatch</h3>
<p>If provided and the target document library specified using TargetServerRelativeLibrary has different fields than the document library where the document is being moved from, the move will succeed. If not provided, it will fail to protect against data loss of metadata stored in fields that cannot be moved along.</p>
<p>Only applicable to: SharePoint Online</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Other Site Collection
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-allowsmallerversionlimitondestination">-AllowSmallerVersionLimitOnDestination</h3>
<p>If provided and the target document library specified using TargetServerRelativeLibrary is configured to keep less historical versions of documents than the document library where the document is being moved from, the move will succeed. If not provided, it will fail to protect against data loss of historical versions that cannot be moved along.</p>
<p>Only applicable to: SharePoint Online</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Other Site Collection
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-confirm">-Confirm</h3>
<p>Prompts you for confirmation before running the cmdlet.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases: cf

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-connection">-Connection</h3>
<p>Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.</p>
<pre><code class="lang-yaml">Type: PnPConnection
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-force">-Force</h3>
<p>If provided, no confirmation will be requested and the action will be performed</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-ignoreversionhistory">-IgnoreVersionHistory</h3>
<p>If provided, only the latest version of the document will be moved and its history will be discared. If not provided, all historical versions will be moved along.</p>
<p>Only applicable to: SharePoint Online</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: Other Site Collection
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-overwriteifalreadyexists">-OverwriteIfAlreadyExists</h3>
<p>If provided, if a file or folder already exists at the TargetUrl, it will be overwritten. If omitted, the move operation will be canceled if the file or folder already exists at the TargetUrl location.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-serverrelativeurl">-ServerRelativeUrl</h3>
<p>Server relative Url specifying the file to move. Must include the file name.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Server Relative
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
</code></pre>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Other Site Collection
Aliases:

Required: False
Position: 0
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
</code></pre>
<h3 id="-siterelativeurl">-SiteRelativeUrl</h3>
<p>Site relative Url specifying the file or folder to move. Must include the file or folder name.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Site Relative
Aliases:

Required: True
Position: 0
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
</code></pre>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Other Site Collection
Aliases:

Required: False
Position: 0
Default value: None
Accept pipeline input: True (ByValue)
Accept wildcard characters: False
</code></pre>
<h3 id="-targetserverrelativelibrary">-TargetServerRelativeLibrary</h3>
<p>Server relative url of a document library where to move the fileor folder to. Must not include the file or folder name.</p>
<p>Only applicable to: SharePoint Online</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Other Site Collection
Aliases:

Required: True
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-targeturl">-TargetUrl</h3>
<p>Server relative Url where to move the file or folder to. Must include the file or folder name.</p>
<pre><code class="lang-yaml">Type: String
Parameter Sets: Site Relative, Server Relative
Aliases:

Required: True
Position: 1
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-web">-Web</h3>
<p>This parameter allows you to optionally apply the cmdlet action to a subweb within the current web. In most situations this parameter is not required and you can connect to the subweb using Connect-PnPOnline instead. Specify the GUID, server relative url (i.e. /sites/team1) or web instance of the web to apply the command to. Omit this parameter to use the current web.</p>
<pre><code class="lang-yaml">Type: WebPipeBind
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h3 id="-whatif">-WhatIf</h3>
<p>Shows what would happen if the cmdlet runs. The cmdlet is not run.</p>
<pre><code class="lang-yaml">Type: SwitchParameter
Parameter Sets: (All)
Aliases: wi

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
</code></pre>
<h2 id="related-links">RELATED LINKS</h2>
<p><a href="https://aka.ms/sppnp">SharePoint Developer Patterns and Practices</a></p>
</article>
          </div>
          <div class="hidden-sm col-md-2" role="complementary">
            <div class="sideaffix">
              <nav class="bs-docs-sidebar hidden-print hidden-xs hidden-sm affix" id="affix">
              </nav>
            </div>
          </div>        </div>
      </div>
      
      <footer>
        <div class="grad-bottom"></div>
        <div class="footer">
          <div class="container">
            <span class="pull-right">
              <a href="#top">Back to top</a>
            </span>
            
            <span>Generated by <strong>DocFX</strong></span>
            <img src="https://telemetry.sharepointpnp.com/@pnp.github.io/index/" alt="spacer">
          </div>
        </div>
      </footer>    </div>
    
    <script type="text/javascript" src="../styles/docfx.vendor.js"></script>
    <script type="text/javascript" src="../styles/docfx.js"></script>
    <script type="text/javascript" src="../styles/main.js"></script>  </body>
</html>